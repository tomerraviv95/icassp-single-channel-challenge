import rfcutils
from data_generation import SIGNAL_LENGTH


def get_soi_generation_fn(soi_sig_type):
    if soi_sig_type == 'QPSK':
        generate_soi = lambda n, s_len: rfcutils.generate_qpsk_signal(n, s_len // 16)
        demod_soi = rfcutils.qpsk_matched_filter_demod
    elif soi_sig_type == 'OFDMQPSK':
        generate_soi = lambda n, s_len: rfcutils.generate_ofdm_signal(n, s_len // 80)
        _, _, _, RES_GRID = rfcutils.generate_ofdm_signal(1, SIGNAL_LENGTH // 80)
        demod_soi = lambda s: rfcutils.ofdm_demod(s, RES_GRID)
    else:
        raise Exception("SOI Type not recognized")
    return generate_soi, demod_soi

